<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ðŸŽ„ GRAN RIFA NAVIDEÃ‘A ðŸŽ„</title>

<!-- Fuente -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --card-bg-img: url('https://i.imgur.com/mf3QMKb.jpeg'); 
    --accent: #ffc107;
    --nequi-color: #003a73;
    --text: #0b2136;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#0b2340;
    font-family:"Poppins", system-ui;
    padding:18px;
  }

  /* ----- CONTENEDOR CORREGIDO ------ */
  .card-wrap{
    width:360px;
    height:640px;        /* visible sin cortar */
    max-height:90vh;     /* nunca mÃ¡s grande que la pantalla */
    overflow-y:auto;     /* aparece scroll si falta espacio */
    border-radius:18px;
    padding:14px;
    background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(250,250,250,0.94));
    box-shadow:0 12px 30px rgba(0,0,0,0.5);
  }

  .card{
    position:relative;
    min-height:100%;      /* evita que se corte abajo */
    border-radius:14px;
    padding:18px 14px;
    overflow:hidden;
    background-color: rgba(255,255,255,0.88);
    display:flex;
    flex-direction:column;
    align-items:center;
  }

  /* Fondo */
  .card::before{
    content:"";
    position:absolute;
    inset:0;
    background-image:var(--card-bg-img);
    background-size:cover;
    background-position:center;
    opacity:.25;
    z-index:0;
  }

  .content{
    position:relative;
    z-index:2;
    width:100%;
    text-align:center;
  }

  .title{
    font-family:"Montserrat",sans-serif;
    font-weight:900;
    font-size:22px;
    color:#fff;
    letter-spacing:1px;
    text-shadow:0 3px 0 rgba(0,0,0,.35),0 6px 20px rgba(0,0,0,.25);
    margin-bottom:6px;
  }

  .meta{
    color:#fff;
    text-shadow:0 1px 2px rgba(0,0,0,.4);
    font-size:13px;
    font-weight:600;
    margin-bottom:12px;
  }

  .value{
    font-family:"Montserrat";
    font-size:34px;
    font-weight:900;
    color:var(--accent);
    background:rgba(0,0,0,.12);
    padding:6px 12px;
    border-radius:10px;
    margin-top:6px;
    box-shadow:0 6px 20px rgba(0,0,0,.25);
  }

  .nequi{
    margin-top:12px;
    background:white;
    padding:10px 14px;
    border-radius:12px;
    font-weight:900;
    color:var(--nequi-color);
    font-size:18px;
    box-shadow:0 6px 16px rgba(0,0,0,.18);
  }

  /* Tabla 00â€“99 */
  .grid{
    margin-top:14px;
    display:grid;
    grid-template-columns:repeat(10,1fr);
    gap:8px;
    width:100%;
    padding:6px;
  }

  .cell{
    background:white;
    border-radius:10px;
    padding:6px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    font-weight:800;
    color:#0b3a66;
    font-size:15px;
    box-shadow:0 4px 8px rgba(3,12,25,.08);
    transition:.12s;
  }

  .cell.sold{
    background:#d62828;
    color:#fff;
    text-decoration:line-through;
  }

  .controls{
    margin-top:14px;
    display:flex;
    gap:10px;
    justify-content:center;
    flex-wrap:wrap;
  }

  .btn{
    background:#0077ff;
    color:white;
    padding:8px 12px;
    border:none;
    border-radius:12px;
    font-weight:800;
    cursor:pointer;
    box-shadow:0 6px 16px rgba(0,119,255,.18);
  }

  .clear{ background:#009688 }

  .smallnote{
    margin-top:8px;
    font-size:11px;
    color:rgba(0,0,0,.6);
  }
</style>
</head>
<body>

<div class="card-wrap">
  <div class="card" id="card">
    <div class="content">
      <div class="title">ðŸŽ„ GRAN RIFA NAVIDEÃ‘A ðŸŽ„</div>
      <div class="meta">Premio: <b>$300.000</b> â€” Sorteo: <b>24 de diciembre</b></div>

      <div class="value">$10.000</div>
      <div class="nequi">Nequi: 3118503614</div>

      <div class="grid" id="grid"></div>

      <div class="controls">
        <button class="btn" id="downloadBtn">ðŸ“¥ Descargar imagen (1080Ã—1920)</button>
        <button class="btn clear" id="clearBtn">ðŸ”„ Limpiar</button>
      </div>

      <div class="smallnote">Toca un nÃºmero para marcarlo como vendido.</div>
    </div>
  </div>
</div>

<!-- html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
(()=>{
  const grid=document.getElementById("grid");
  const key="rifa_sold_v2";
  let sold=new Set(JSON.parse(localStorage.getItem(key)||"[]"));

  for(let i=0;i<100;i++){
    const n=i.toString().padStart(2,"0");
    const c=document.createElement("div");

    c.className="cell";
    c.textContent=n;
    c.dataset.num=n;

    if(sold.has(n)) c.classList.add("sold");

    c.onclick=()=>{
      if(c.classList.contains("sold")){ c.classList.remove("sold"); sold.delete(n); }
      else{ c.classList.add("sold"); sold.add(n); }
      localStorage.setItem(key,JSON.stringify([...sold]));
    };

    grid.appendChild(c);
  }

  document.getElementById("clearBtn").onclick=()=>{
    if(!confirm("Â¿Limpiar todos los marcados?"))return;
    sold.clear();
    document.querySelectorAll(".cell.sold").forEach(el=>el.classList.remove("sold"));
    localStorage.setItem(key,"[]");
  };

  document.getElementById("downloadBtn").onclick=async()=>{
    const card=document.getElementById("card");
    const targetW=1080,targetH=1920;

    const rect=card.getBoundingClientRect();
    const scale=Math.min(targetW/rect.width,targetH/rect.height);

    const canvas=await html2canvas(card,{
      backgroundColor:null,
      scale:Math.round(scale*window.devicePixelRatio),
      useCORS:true
    });

    const final=document.createElement("canvas");
    final.width=targetW;
    final.height=targetH;
    const ctx=final.getContext("2d");

    ctx.fillStyle="#fff";
    ctx.fillRect(0,0,targetW,targetH);

    const s=Math.min(targetW/canvas.width,targetH/canvas.height);
    const w=canvas.width*s;
    const h=canvas.height*s;

    ctx.drawImage(canvas,(targetW-w)/2,(targetH-h)/2,w,h);

    const a=document.createElement("a");
    a.download="rifa_1080x1920.png";
    a.href=final.toDataURL();
    a.click();
  };
})();
</script>

</body>
</html>
